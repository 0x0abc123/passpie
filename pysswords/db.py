import os
import gnupg


def key_input(passphrase):
    return gnupg.GPG().gen_key_input(
        name_real="Pysswords",
        name_email="pysswords@pysswords",
        name_comment="Auto-generated by Pysswords",
        key_length=4096,
        expire_date=0,
        passphrase=passphrase
    )


def keys_path(path):
    return os.path.join(path, ".keys")


def create_keys(keyring_path, passphrase):
    gpg = gnupg.GPG(homedir=keyring_path)
    key = gpg.gen_key(key_input(passphrase))
    return key


def create_keyring(path, passphrase):
    create_keys(keys_path(path), passphrase)


def create(path):
    os.makedirs(path)
